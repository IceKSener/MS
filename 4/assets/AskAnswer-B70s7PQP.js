import{_ as y,g as h,u as k,r as _,a as A,o as c,c as d,b as a,w as T,v as $,n as r,d as u,F as b,e as q,t as C,f as N,h as S,i as B,j as E}from"./index-20SuupcP.js";const F={class:"question"},M={key:0},V={__name:"AskAnswer",setup(I){let m=h().proxy.config,i=h().proxy.screen,o=0;const v=k("answers"),p=_([]),f=_(""),w=n=>new Promise(e=>setTimeout(e,n));async function x(n){if(n=n.trim(),!m.loginStatus.isLogged){B.emit("startLogin");return}let e=E({question:n,text:"",status:"unfinished"});++o;let s="";n.length<=0?fetch("https://api.shadiao.pro/chp").then(l=>l.json()).then(l=>{s=`(w´ω｀w)
`+l.data.text,e.status="finished"}).catch(l=>{s=`请求出错!
`,e.status="error",console.log(l)}):(s="你问我："+n+`?
我想想......`,setTimeout(()=>{s+=`
我不知道，我只知道$\\int_{${-o}}^{${o}}${o==1?"":o}x^2\\,dx=${(2*o**4/3).toFixed(2)}$
`,s+="(已经实现异步分段显示)",e.status="finished"},3e3)),p.value.push(e),setTimeout(()=>v.value.scrollTo(0,Number.MAX_SAFE_INTEGER),100);let t=0;for(;;){if(t<s.length)e.text+=s.at(t),++t;else if(e.status!="unfinished")break;await w(1e3/m.settings.charPerSecond)}}function g(){p.value.length=0}return(n,e)=>{const s=A("Markdown");return c(),d("div",{class:r(["area",u(i).type])},[a("div",{class:r(["request",u(i).type])},[T(a("textarea",{type:"text",class:r(["requestbox",u(i).type]),"onUpdate:modelValue":e[0]||(e[0]=t=>f.value=t),placeholder:"你想问啥，不问也行"},null,2),[[$,f.value]]),a("div",{class:r(["submit",u(i).type]),onClick:e[1]||(e[1]=t=>x(f.value))},"提问",2)],2),a("div",{class:r(["answers",u(i).type]),ref_key:"answers",ref:v},[a("div",null,[a("button",{onClick:g},"清空")]),(c(!0),d(b,null,q(p.value,t=>(c(),d("div",{class:r(["chat",t.status])},[a("div",F,C(t.question),1),N(s,{class:"answer",md:t.text},null,8,["md"]),t.status=="unfinished"?(c(),d("div",M,"......")):S("",!0)],2))),256))],2)],2)}}},j=y(V,[["__scopeId","data-v-357dd07f"]]);export{j as default};
